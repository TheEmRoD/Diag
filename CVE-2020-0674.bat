::Script  regarding CVE-2020-0674
https://meterpreter.org/tag/cve-2020-0674/
https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/ADV200001

IF NOT EXIST C:\!Diagonal MD C:\!Diagonal
set LOGS=C:\!Diagonal\CVE-2020-0674.log


::Query OS Locale
FOR /F "tokens=2 delims==" %%a IN ('wmic os get locale /Value') DO set OSLocale=%%a>>%LOGS%


IF EXIST %windir%\syswow64\jscript.dll takeown /f %windir%\syswow64\jscript.dll>>%LOGS%
IF EXIST %windir%\system32\jscript.dll takeown /f %windir%\system32\jscript.dll>>%LOGS%

IF [%OSLocale%] EQU [040c] (
	:: SI OS Fr
	IF EXIST %windir%\syswow64\jscript.dll cacls %windir%\syswow64\jscript.dll /E /P "tout le monde":N>>%LOGS%
	IF EXIST %windir%\system32\jscript.dll cacls %windir%\system32\jscript.dll /E /P "tout le monde":N>>%LOGS%
 ) ELSE (
	:: Sinon
	IF EXIST %windir%\syswow64\jscript.dll cacls %windir%\syswow64\jscript.dll /E /P everyone:N>>%LOGS%
	IF EXIST %windir%\system32\jscript.dll cacls %windir%\system32\jscript.dll /E /P everyone:N>>%LOGS%
)

::exit
